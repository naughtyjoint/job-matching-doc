openapi: 3.0.1
info:
  title: 工作媒合平台
  version: 1.0.0
tags:
  - name: 會員
  - name: 工作
  - name: 招募
  - name: 任務
paths:
  #user
  /v1/user/info/{user_id}:
    get:
      tags:
        - 會員
      summary: 取得會員資訊
      operationId: getUserInfo
      parameters:
        - $ref: '#/components/parameters/userIdParam'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      res:
                        allOf:
                          - type: object
                            properties:
                              id:
                                type: integer
                                description: 會員編號
                          - $ref: '#/components/schemas/User'
  /v1/user/create:
    post:
      tags:
        - 會員
      summary: 新增會員
      operationId: addUser
      requestBody:
        description: 會員資訊
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
        required: true
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      res:
                        type: object
                        allOf:
                          - $ref: '#/components/schemas/User'
                          - type: object
                            properties:
                              id:
                                type: integer
                                description: 會員編號
  /v1/user/update:
    post:
      tags:
        - 會員
      summary: 更新會員資訊
      operationId: updateUser
      requestBody:
        description: 會員資訊
        content:
          application/json:
            schema:
              allOf:
                - type: object
                  properties:
                    id:
                      type: integer
                - $ref: '#/components/schemas/User'
        required: true
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      res:
                        type: object
                        allOf:
                          - $ref: '#/components/schemas/User'
                          - type: object
                            properties:
                              id:
                                type: integer
                                description: 會員編號
  /v1/user/{user_id}:
    delete:
      tags:
        - 會員
      summary: 刪除會員
      operationId: deleteUser
      parameters:
        - $ref: '#/components/parameters/userIdParam'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      res:
                        type: boolean
  /v1/user/profile/{user_id}:
    get:
      tags:
        - 會員
      summary: 取得會員詳細資料
      operationId: getUserProfile
      parameters:
        - $ref: '#/components/parameters/userIdParam'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      res:
                        allOf:
                          - type: object
                            properties:
                              user_id:
                                type: integer
                                description: 會員編號
                          - $ref: '#/components/schemas/UserProfile'
  /v1/user/profile:
    post:
      tags:
        - 會員
      summary: 設定會員詳細資料
      operationId: setUserProfile
      requestBody:
        description: 會員詳細資料
        content:
          application/json:
            schema:
              allOf:
                - type: object
                  properties:
                    user_id:
                      type: integer
                - $ref: '#/components/schemas/UserProfile'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      res:
                        allOf:
                          - type: object
                            properties:
                              user_id:
                                type: integer
                                description: 會員編號
                          - $ref: '#/components/schemas/UserProfile'

  #job
  /v1/job/info/{job_id}:
    get:
      tags:
        - 工作
      summary: 取得案件資訊
      operationId: getJobInfo
      parameters:
        - $ref: '#/components/parameters/jobIdParam'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      res:
                        allOf:
                          - type: object
                            properties:
                              id:
                                type: integer
                                description: 工作編號
                            required:
                              - id
                          - $ref: '#/components/schemas/Job'
                          - type: object
                            properties:
                              detail:
                                $ref: '#/components/schemas/JobDetail'
  /v1/job/create:
    post:
      tags:
        - 工作
      summary: 新增工作
      operationId: addJob
      requestBody:
        description: 工作資訊
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Job'
        required: true
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      res:
                        type: object
                        allOf:
                          - $ref: '#/components/schemas/Job'
                          - type: object
                            properties:
                              id:
                                type: integer
                                description: 工作編號
                            required:
                              - id
  /v1/job/detail:
    post:
      tags:
        - 工作
      summary: 設定工作詳情
      operationId: setJobDetail
      requestBody:
        description: 工作資訊
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JobDetail'
        required: true
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      res:
                        type: object
                        allOf:
                          - $ref: '#/components/schemas/Job'
                          - type: object
                            properties:
                              id:
                                type: integer
                                description: 工作編號
                            required:
                              - id
  /v1/job/recommend:
    get:
      tags:
        - 工作
      summary: 推薦工作案件
      operationId: getJobRecommend
      parameters:
        - name: user_id
          in: query
          description: 會員id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      res:
                        allOf:
                          - type: object
                            properties:
                              id:
                                type: integer
                                description: 工作編號
                            required:
                              - id
                          - $ref: '#/components/schemas/Job'
  
  #recruitment
  /v1/job/recruit:
    post:
      tags:
        - 招募
      summary: 招募求職者（徵才）
      description: 由業主主動對網站求職者發起招募
      operationId: recruitUser
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RecruitmentReqBody'
        required: true
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResWitNull'
  /v1/job/apply:
    post:
      tags:
        - 招募
      summary: 求職者主動尋求招募機會（應徵）
      description: 由求職者向業主提出工作意願
      operationId: userApply
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RecruitmentReqBody'
        required: true
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResWitNull'
  /v1/recruitment/reject/{recruitment_id}:
    get:
      tags:
        - 招募
      summary: 拒絕招募
      description: 業主方或求職者方拒絕招募請求
      operationId: rejectRecruitment
      parameters:
        - $ref: '#/components/parameters/RecruitmentParam'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResWitNull'
  /v1/recruitment/read/{recruitment_id}:
    get:
      tags:
        - 招募
      summary: 讀取招募訊息
      description: 業主方或求職者方讀取招募請求
      operationId: readRecruitment
      parameters:
        - $ref: '#/components/parameters/RecruitmentParam'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResWitNull'
  /v1/recruitment/list:
    get:
      tags:
        - 招募
      summary: 業主查看相關招募清單
      description: 業主查看現有所有招募清單
      operationId: recruitmentList
      parameters:
        - name: owner_id
          in: query
          description: 業主id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      res:
                        type: array
                        items:
                          $ref: '#/components/schemas/Recruitment'
  /v1/recruitment/invitation:
    get:
      tags:
        - 招募
      summary: 求職者查看徵才清單
      description: 求職方查看招募方主動發起的招募邀請列表
      operationId: recruitmentInvitation
      parameters:
        - $ref: '#/components/parameters/userIdQryParam'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      res:
                        type: array
                        items:
                          $ref: '#/components/schemas/Recruitment'
  /v1/recruitment/application:
    get:
      tags:
        - 招募
      summary: 求職者查看應徵清單
      description: 求職方查看自己發起的招募應徵列表
      operationId: recruitmentApplication
      parameters:
        - $ref: '#/components/parameters/userIdQryParam'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      res:
                        type: array
                        items:
                          $ref: '#/components/schemas/Recruitment'
  /v1/recruitment/interview:
    post:
      tags:
        - 招募
      summary: 發請面試邀請
      description: 由業主向求職者發請面試邀請
      operationId: createInterview
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InterviewReqBody'
        required: true
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResWitNull'

  #任務
  /v1/task/create:
    post:
      tags:
        - 任務
      summary: 排定工作任務
      description: 排定工作任務
      operationId: createTask
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                job_id:
                  type: integer
                user_id:
                  type: integer
                wage:
                  type: integer
                start_date:
                  type: string
                end_date:
                  type: string
                memo:
                  type: string
        required: true
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResWitNull'
  /v1/task/update:
    post:
      tags:
        - 任務
      summary: 更新工作任務內容
      description: 更新工作任務內容
      operationId: updateTask
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                job_id:
                  type: integer
                user_id:
                  type: integer
                wage:
                  type: integer
                start_date:
                  type: string
                end_date:
                  type: string
                memo:
                  type: string
        required: true
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResWitNull'
  /v1/task/user/{user_id}:
    get:
      tags:
        - 任務
      summary: 勞工查看任務列表
      description: 勞工查看任務列表
      operationId: getUserTask
      parameters:
        - $ref: '#/components/parameters/userIdParam'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResWitNull'
  /v1/task/owner/{user_id}:
    get:
      tags:
        - 任務
      summary: 業主查看任務列表
      description: 業主查看任務列表
      operationId: getOwnerTask
      parameters:
        - $ref: '#/components/parameters/userIdParam'
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResWitNull'
  /v1/task/{task_id}/status/{status}:
    get:
      tags:
        - 任務
      summary: 更新任務狀態
      description: |
        更新任務狀態，狀態列表如下

        (0: 尚未執行、1: 執行中、2: 執行結束、3: 已結算)
      operationId: updateTaskStatus
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResWitNull'
  /v1/task/rate:
    post:
      tags:
        - 任務
      summary: 勞工評分任務
      description: 勞工對指定任務評分，分數範圍為1至5
      operationId: rateTask
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResWitNull'
  /v1/task/comment:
    post:
      tags:
        - 任務
      summary: 勞工評論任務
      description: 勞工對指定任務發表評論
      operationId: commentTask
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResWitNull'
  /v1/task/owner/rate:
    post:
      tags:
        - 任務
      summary: 業主評分任務
      description: 業主對指定任務評分，分數範圍為1至5
      operationId: ownerRateTask
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResWitNull'
  /v1/task/owner/comment:
    post:
      tags:
        - 任務
      summary: 業主評論任務
      description: 業主對完成指定任務之勞工發表評論
      operationId: ownerCommentTask
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResWitNull'

components:
  parameters:
    pageParam:
      name: page
      in: query
      description: 頁數(預設為1)
      schema:
        type: integer
    limitParam:
      name: limit
      in: query
      description: 單頁筆數(預設為24)
      schema:
        type: integer
    userIdParam:
      name: user_id
      in: path
      description: 會員id
      required: true
      schema:
        type: integer
    userIdQryParam:
      name: user_id
      in: query
      description: 會員id
      required: true
      schema:
        type: integer
    jobIdParam:
      name: job_id
      in: path
      description: 工作案件id
      required: true
      schema:
        type: integer
    RecruitmentParam:
      name: recruitment_id
      in: path
      description: 招募物件id
      required: true
      schema:
        type: integer

  schemas:
    ApiResponse:
      type: object
      properties:
        msg:
          type: string
          example: success
        res:
          type: object
      required:
        - msg
        - res
    User:
      type: object
      properties:
        name:
          type: string
          description: 姓名
        en_name:
          type: string
          description: 英文名
        sex:
          type: integer
          description: 性別(0:女 1:男)
          enum: [0, 1]
        birthday:
          type: string
          format: date
          description: 生日
        marital_status:
          type: integer
          description: 婚姻狀態
        phone:
          type: object
          description: 電話號碼
          properties:
            phoen_1:
              type: string
            phoen_2:
              type: string
            phoen_3:
              type: string
        special_id:
          type: integer
          description: 特殊身分
        email:
          type: string
          format: email
          description: 信箱
        email_verified_at:
          type: string
          description: 信箱認證時間
        contact_time:
          type: object
          description: 聯絡時間
        education:
          type: object
          description: 教育背景
        skills:
          type: object
          description: 技能
        mug_shot_img:
          type: string
          description: 大頭貼
        location:
          type: object
          properties:
            city:
              type: string
            dist:
              type: string
          description: 所在地區
        address:
          type: string
          description: 地址
        public_info:
          type: object
          description: 公開資訊
        public_contact_info:
          type: object
          description: 公開聯絡資訊
        privacy_setting:
          type: object
          properties:
            job_match:
              type: boolean
            match_inform:
              type: boolean
            public_profile:
              type: boolean
          description: 隱私設定資訊
        last_login:
          type: string
          format: date-time
          description: 最後登入時間
      required:
        - id
        - name
        - en_name
        - sex
        - birthday
        - marital_status
        - phone
        - special_id
        - email
        - email_verified_at
        - contact_time
        - education
        - skills
        - mug_shot_img
        - location
        - address
        - public_info
        - public_contact_info
        - privacy_setting
        - last_login
    UserProfile:
      type: object
      properties:
        user_id:
          type: integer
          description: 會員編號
        statue:
          type: integer
          description: 狀態
        vehicles:
          type: array
          description: 交通工具列表
          items:
            type: string
        experiences:
          type: object
          description: 經歷
        education:
          type: array
          description: 學歷
        lang_skill:
          type: array
          description: 外語能力
          items:
            $ref: '#/components/schemas/LangSkill'
        certificates:
          type: array
          description: 證照列表
          items:
            $ref: '#/components/schemas/Certificate'
        it_skills:
          type: array
          description: IT技能列表
          items:
            type: object
        bio:
          type: string
          description: 自傳
        bio_en:
          type: string
          description: 英文自傳
      required:
        - user_id
        - statue
        - vehicles
        - experiences
        - education
        - lang_skill
        - certificates
        - it_skills
        - bio
        - bio_en
    LangSkill:
      type: object
      properties:
        lang:
          type: string
          description: 語言
        l:
          type: integer
          description: 聽力能力
        s:
          type: integer
          description: 口說能力
        r:
          type: integer
          description: 閱讀能力
        w:
          type: integer
          description: 寫作能力
      required:
        - lang
        - l
        - s
        - r
        - w
    Certificate:
      type: object
      properties:
        code:
          type: integer
          description: 類別代號
        category:
          type: string
          nullable: true
          description: 自訂類別
        detail:
          type: string
          nullable: true
          description: 自訂項目
      required:
        - code
        - category
        - detail
    Job:
      type: object
      properties:
        owner_id:
          type: integer
          description: 業主編號
        corp_id:
          type: integer
          description: 企業編號
          nullable: true
        name:
          type: string
          description: 案件名稱
        special_id:
          type: integer
          description: 特殊身份編號
          nullable: true
        identity:
          type: integer
          description: 身份編號
        industry:
          type: array
          description: 產業列表
          items:
            type: integer
        demand_amount:
          type: integer
          description: 需求人數
        status:
          type: integer
          description: 案件狀態
        location:
          type: object
          description: 案件所在地區
          properties:
            city:
              type: string
              description: 縣市
            dist:
              type: string
              description: 區域
        address:
          type: string
          description: 案件所在地址
        wage:
          type: object
          description: 案件薪酬
          properties:
            type:
              type: integer
              description: 薪酬種類
            amount:
              type: integer
              description: 薪資
        description:
          type: string
          description: 案件內容敘述
      required:
        - owner_id
        - corp_id
        - name
        - special_id
        - identity
        - industry
        - demand_amount
        - status
        - location
        - address
        - wage
        - description
        - detail
    JobDetail:
      type: object
      properties:
        job_id:
          type: integer
          description: 案件編號
        vehicles:
          type: array
          description: 需求交通工具列表
          items:
            type: string
        education:
          type: array
          description: 學歷需求
          nullable: true
        lang_skill:
          type: array
          description: 語言需求
          items:
            $ref: '#/components/schemas/LangSkill'
        certificates:
          type: array
          description: 證照需求
          items:
            $ref: '#/components/schemas/Certificate'
        it_skills:
          type: array
          description: IT技能需求
          items:
            type: object
        skills:
          type: array
          description: 技能需求
          items:
            type: string
        other_demand:
          description: 其他需求
          type: string
      required:
        - job_id
        - vehicles
        - experiences
        - education
        - lang_skill
        - certificates
        - it_skills
        - skills
        - other_demand
    Recruitment:
      type: object
      properties:
        id:
          type: integer
          description: 招募編號
        job_id:
          type: integer
          description: 對應工作案件編號
        owner_id:
          type: integer
          description: 業主編號
        corp_id:
          type: integer
          description: 企業編號
          nullable: false
        candidate_id:
          type: integer
          description: 招募對象會員編號
        type:
          type: integer
          description: 招募種類（1：招募方徵才，2：求職方應徵）
        status:
          type: integer
          description: 招募狀態（0：一般，1：已婉拒）
        read:
          type: integer
          description: 招募訊息已讀狀態（0：未讀，1：已讀）
        job:
          allOf:
            - type: object
              properties:
                id:
                  type: integer
                  description: 案件編號
              required:
                - id
            - $ref: '#/components/schemas/Job'
      required:
        - id
        - job_id
        - owner_id
        - corp_id
        - candidate_id
        - type
        - status
        - read
        - job
    RecruitmentReqBody:
      type: object
      properties:
        job_id:
          type: integer
          description: 工作案件編號
        candidate_id:
          type: integer
          description: 招募對象user id
      required:
        - job_id
        - candidate_id
    InterviewReqBody:
      type: object
      properties:
        recruitment_id:
          type: integer
          description: 招募編號
        interview_time:
          type: string
          description: 面試時間
        address:
          type: string
          description: 面試地點
        description:
          type: string
          description: 面試說明
      required:
        - recruitment_id
        - interview_time
        - address
        - description
    ResWitNull:
      allOf:
        - $ref: '#/components/schemas/ApiResponse'
        - type: object
          properties:
            res:
              type: object
              nullable: true
              example: null
              description: 成功則回傳null
        
